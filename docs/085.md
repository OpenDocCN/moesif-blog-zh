# API 安全性和 FHIR 建议

> 原文:[https://www . moesif . com/blog/Podcast/API-Security/Podcast-API-Security-and-FHIR-Recommendations/](https://www.moesif.com/blog/podcasts/api-security/Podcast-API-Security-and-FHIR-Recommendations/)

Ep。12:艾丽莎·奈特(Alissa Knight)，康复黑客和 API 安全专家

### Moesif 的播客网络:为 API 产品经理和其他 API 专业人士提供可操作的见解。

加入我们的是 [Alissa Knight](https://www.alissaknight.com/about) ，她是 CISO Knight Ink Media 的合伙人，网络安全专家、电影摄影师和出色的内容创作者，擅长大规模讲述品牌故事。

莫里斯国际基金会的 CMO 拉里·埃布林格是今天的主持人。

[https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/1130100358&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true](https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/1130100358&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true)

[Moesif](https://soundcloud.com/moesifhq "Moesif") · [12\. API Security and FHIR Recommendations](https://soundcloud.com/moesifhq/12-api-security-and-fhir-recommendations "12\. API Security and FHIR Recommendations")

在 SoundCloud 上听这一集，在我们的 [YouTube 频道](https://www.youtube.com/watch?v=yngrkxX4Qak)上观看，或者在苹果或谷歌上下载。

[![Listen on Apple Podcasts](img/0f035c1005fd9c71c8f40242b9519f3d.png)](https://podcasts.apple.com/us/podcast/12-api-security-and-fhir-recommendations/id1545437670?i=1000536453200) [![Listen on Google Podcasts](img/5dde28e33453b3096c5f996f6d62b5af.png)](https://podcasts.google.com/feed/aHR0cHM6Ly9mZWVkcy5zb3VuZGNsb3VkLmNvbS91c2Vycy9zb3VuZGNsb3VkOnVzZXJzOjg4ODY5ODI0NS9zb3VuZHMucnNz/episode/dGFnOnNvdW5kY2xvdWQsMjAxMDp0cmFja3MvMTEzMDEwMDM1OA?sa=X&ved=0CAUQkfYCahcKEwio1ealpZjzAhUAAAAAHQAAAAAQCA&hl=en)

目录

*   [2:23 免狱黄——成为一个有道德的黑客](#avoid-prison-yellow---become-an-ethical-hacker)
*   [5:43 认证不等于授权](#authentication-does-not-equal-authorization)
*   [8:14 用瞄准镜防流星雨](#protect-against-bola-with-scopes)
*   [10:06 不要用 WAFs 来保护你的 API](#do-not-use-wafs-to-protect-your-apis)
*   [13:08 知道你的 API 有哪些流量](#know-what-traffic-is-going-to-your-api)
*   [14:35 向左移动安全护罩向右移动](#shift-left-security---shield-right)
*   [17:39 PHI 值 1000 倍信用卡信息](#phi-is-worth-a-thousand-times-credit-card-info)
*   [21:41 原料药是医疗保健领域最薄弱的环节](#apis-are-the-weakest-link-in-healthcare)
*   [24:27API 有多个攻击面](#apis-have-multiple-attack-surfaces)

*   [29:40 使用 MobSF 查找 API 密钥](#use-mobsf-to-find-api-keys)
*   [30:44API 需要符合 FHIR](#apis-need-to-comply-with-fhir)
*   [34:55 正确实现 FHIR】](#implement-fhir-correctly)
*   [37:11 获得 FHIR 认证](#get-fhir-certified)
*   [38:11 FHIR 认证与 HIPAA 合规性](#fhir-certification-versus-hipaa-compliance)
*   [39:59 没有一个合适的 API 安全解决方案](#no-one-right-solution-for-api-security)
*   [42:59 检测您的 API](#instrument-your-apis)

拉里·埃布林格(Moesif): 欢迎来到 Moesif 的 APIs over IPAs 播客网络的第 12 集。我是劳伦斯·埃布林格，今天的主持人，也是 Moesif 的首席营销官，API 可观测性平台。

和我一起的是艾丽莎·奈特，CISO(首席信息安全官)，网络安全专家，电影摄影师和出色的内容创作者，擅长大规模讲述品牌故事。她是一个定期的会议发言人，这也是我第一次在 apidays 界面会议上看到她做主题发言的地方。她正在做一个关于安全和医疗保健应用的精彩演讲，我想我们的观众会很乐意听到她对 API 安全性的看法。

所以我们在这里。欢迎艾丽莎。我们在哪里能找到你？

**艾丽莎·奈特(奈特墨媒):**所以，首先感谢拉里。这是一个伟大的介绍。我总是为人们不得不提供我的简历和介绍我感到难过，因为这感觉就像可以永远继续下去。所以我要开始让人们介绍我，你知道，那个“安全小妞”，那个“黑客小妞”但是不，谢谢你邀请我参加你的节目。很荣幸来到这里。非常感谢。

所以我在拉斯维加斯。很多人不知道有人住在这里。这不仅仅是为了参加会议，而且人们确实住在这里。我和妻子住在一个叫萨姆林的地方，离加沙大约 20 分钟的路程。

**Larry:** 很高兴你能参加我们的节目，我们很高兴你能和我们分享你对安全的看法。

顺便提一下，当我向家人提到我在我们的播客上主持你时，我一个 12 岁的女儿问你是白帽子还是黑帽子。科技语言已经变得如此主流，甚至连十几岁的孩子都很熟悉。因此，为什么不与我们分享你从黑帽到白帽的历程，创办两家网络安全公司，然后到今天经营 Knight Inc. Media。

## 避免监狱黄-成为一个道德黑客

*“快进到我 17 岁的时候。我做了一个非常糟糕的决定，黑了一个政府网络。被抓了…最后在网络战中为美国情报部门工作。”即使你一开始是一名黑帽黑客，你也可能成为一名道德黑客。*

艾丽莎:所以，令人惊讶的是，即使是 12 岁的孩子也知道黑帽子和白帽子之间的特殊区别。很好的问题，我认为这是一个很好的开场方式。

我大约 13 岁的时候开始从事黑客工作。不幸的是，我很少有指导。但是当时的情况非常不同。你说的是一个不同的时代，那时你还没有今天所有这些可用的资源。你知道，那时还没有 SANS，甚至谷歌。

我通过 IRC 参与了黑客活动。有一个 IRC 服务器，互联网中继聊天，叫做 EFnet，我非常喜欢这些 EFnet IRC 频道。所以，那真的是我的家人。因为，我的意思是我花在网上的时间比和家人互动的时间还多，所以他们几乎把我养大。我是在 IRC 上长大的。

在这些渠道中，我通过其他人学习，也通过自己学习。当时，外面的知识非常少。如今，通过谷歌和所有这些资源，我们可以获得如此多的知识，但那时候真的很难学。你真的需要靠自己去学习。

快进到我 17 岁的时候。我做了一个非常糟糕的决定，黑了一个政府网络。被抓了，他们在学校逮捕了我，信不信由你。在指控被撤销后，他最终在网络战领域为美国情报部门工作。所以我被迫扮演一个白帽子的角色。我穿橙色很难看。监狱不适合我。

我脱离了自己的控制，从黑帽子变成了白帽子，这很好，因为我意识到我是谁，我很清楚，我可以做我最喜欢的事情，赚很多钱，那就是黑客。

因此，渗透测试/道德黑客技术诞生了——实际上是黑客攻击公司网络，并向他们解释我们是如何做的，以便他们能够抵御真正的攻击者。

拉里:我觉得没人穿橙色那么好看。

**艾丽莎:**橙色不是新的艾丽莎骑士。

**Larry:** 在你的一个很棒的 [YouTube 视频](https://www.youtube.com/c/AlissaKnight/videos)中，顺便说一下，我推荐我们的听众收听，你给黑客下了一个精彩的定义，它是一个想要理解事物如何工作的人，然后发送一个开发者没有预料到或考虑到的刺激。所以，并不像人们想象的那么邪恶。同样，在你的 YouTube 和博客内容上，你真的用大量的经验数据来支持你所有的主张，这真的使它更有价值。

## 认证不等于授权

开发人员在开发 API 时最大的系统性问题是，他们会记得对 API 请求进行认证，但却无法授权。理解授权和认证之间的区别:您可能有一个 API 密匙来证明您有发送 API 调用的合法权限，但是您不一定被授权接收您所请求的数据。

**Larry:** 所以，作为一个坐在桌子两边的人，可以这么说，并且写了大量关于黑客攻击银行&健康技术应用编程接口的文章，现在我刚刚听说了一个政府网络。最近有人向 Gartner 报告了您对 API 安全性的看法，开发人员在 API 安全性方面最常犯的错误是什么？

艾丽莎:好问题。我认为，对我来说，最系统的问题是开发人员会记得认证 API 请求，但他们不会授权它。所以，这是理解授权和认证之间的区别。身份验证是您拥有或知道的东西，而授权是被允许实际查看数据。

我可能有一个 API 令牌或 API 密钥来证明我有一个合法的用户帐户，可以合法地访问 API 来发送 API 调用，但是我无权接收我所请求的数据。这是我所看到的所有 API 都存在的一个问题，就是缺乏授权。特别是围绕所谓的[破坏对象级授权(BOLA)](https://apisecurity.io/encyclopedia/content/owasp/api1-broken-object-level-authorization.htm) 漏洞。

对于那些不完全理解这意味着什么的听众来说，我最喜欢用的比喻是整个衣帽间的事情。如果你和我去参加一个鸡尾酒会，我看到你把你那件昂贵的[博柏利外套](https://us.burberry.com/the-mid-length-kensington-heritage-trench-coat-p40734831)寄存在衣帽间，我想把它带回家。衣帽间的人给了你 18 号，我得到了 17 号，我拿了一支记号笔，把 7 号换成 8 号，然后把它还给衣帽间，说我想要我的大衣。这是 BOLA 漏洞的一个很好的例子。我通过验证了，我有票，但是我没有权利把你的博柏利外套带回家。授权漏洞基本上就是这样工作的。

## 用望远镜防止流星雨

当您没有指定您的用户有权访问的内容时，BOLA 漏洞经常发生。如果您使用像 OATH 这样的令牌，那么您可以通过将作用域绑定到令牌来限制访问。

拉里:你实际上抢先问了我最后一个关于博拉的问题。请告诉我们，我们的开发人员如何防范此类 BOLA 攻击。

艾丽莎:所以你可以做不同的事情。我注意到的一件事是许多开发者会实现令牌，但他们不会实现[范围](https://oauth.net/2/scope/)。一个非常重要的建议是，如果你要实现 OATH 之类的令牌，你要确保你将范围与这些令牌联系起来，这些令牌定义了访问级别或允许你查看的记录。它基本上围绕您的令牌设置参数，并定义您可以请求什么。举例来说，如果我是一名临床医生，我有一个登录帐户，通过这些示波器，我只能查看这些特定的患者。或者，如果我是一名患者，我的令牌的范围应该只允许我查看我的患者记录，而不是/patient/1，2，3，4，5，所有这些其他患者记录。我应该只能要求我的特定病人记录。

显然也有商业解决方案可以实现这一点。但是我发现的许多漏洞只是基本的授权问题。它们不像 sequel injection，可以由传统的 [Web 应用防火墙(WAFs)](https://en.wikipedia.org/wiki/Web_application_firewall) 来处理。waf 非常适合基于规则/基于逻辑的安全控制，因此无法真正抵御 BOLA 攻击。

## 不要使用 WAFs 来保护你的 API

分析师已经将 Web 应用防火墙和 API 网关提升为抵御 API 攻击的有效安全控制手段。waf 对于识别有效负载中的 sequel 注入或跨站点脚本很有用，但是它们不能知道我是否被授权查看我所请求的数据。

关于基于规则的 waf，比如 ModSecurity 甚至 API 网关，我注意到在你最近的一篇 YouTube 帖子中，你说它们对保护你的 API 毫无用处。

艾丽莎:我很固执己见！

**Larry:** 有趣的是，我认为这是来自 Gartner [的 2019 年报告，你需要做什么来保护你的 API](https://www.gartner.com/en/documents/3956746/api-security-what-you-need-to-do-to-protect-your-apis)，他们在报告中拥护 API 网关和 WAFs 的优点。然后你上了 Gartner，基本上把它否决了。

艾丽莎:我觉得他们不太喜欢我。

Larry: 还有什么可以做的，比如先进的异常检测，可以进一步保护你的 API。

艾丽莎:这是我的立场。我不认为安全性应该成为产品的一个特征。例如，当您有一个 API 网关时，他们会将安全性作为一项功能添加到他们的主要职责中。对我来说，这是一个问题。

Gartner 发布了一份关于 Web 应用程序防火墙的报告，其中他们说 WAFs 是针对企业的有效安全控制。这是我可以整天谈论的事情——关于付费游戏和分析师行业之类的东西。但我不会去那里。事实是，我认为这造成了这种虚假的安全感，因为 CISOs 正在购买 WAFs，他们正在实施 API 网关并打开安全性，这造成了这种虚假的安全感。

我最近入侵的每一个 API 都受到 WAFs 的保护。这些首席信息官正在倾听来自分析师行业的信息，他们不得不发表和谈论这些信息，因为这些是他们的付费客户。但问题是，它们不是抵御 API 攻击的有效安全控制措施。WAF 如何知道我是否应该请求不属于我的数据？它将在有效载荷中寻找 sequel 注入、跨站点脚本攻击之类的东西。但是它不知道我是否被授权查看某些东西，这超出了它的理解范围。我认为这回答了你问题的四分之三，另外四分之一是什么？

## 了解哪些流量流向您的 API

保护您的 API 的第一步是了解它实际上要做什么。合法的人流量和合成的流量有很大的不同。你不能保护你不知道自己拥有的东西。

**Larry:** 如果 WAFs 和 API 网关不摆动它，你怎么保护你的 API？事实上，我认为你提到了一个非常有说服力的观点，我也在你的 YouTube 频道中听到过，那就是许多 CISOs 和开发人员将安全性视为事后的想法或附加条件。你说，不要这样，你应该从一开始就把安全作为重要的考虑因素。

我想以这样一个事实作为这个答案的开头，即任何拥有 API 的组织都需要知道他们的 API 将会得到什么。他们需要知道:这是人流量——合法的人流量，是合成流量，还是使用[凭证填充](https://owasp.org/www-community/attacks/Credential_stuffing)的账户接管(ATO)攻击？寻找高频工具也是一个好主意，这些工具可能会持续攻击您的 API，并从合法用户那里窃取非常昂贵的带宽和资源。每个人都应该知道自己拥有什么——你无法保护你不知道自己拥有的东西。这非常重要。因此，我想以这样一个事实作为开始，即您应该知道流向您的 API 的流量内部是什么。

## 向左移动安全护罩向右移动

使用双管齐下的方法在编写代码时实现安全性，让开发人员参加安全代码培训，并使用工具在编写不安全的代码时发出警告。保护权:在你的保护被部署到生产中后保护它。

**Alissa:** 在了解哪些类型的流量流向您的 API 后，最重要的事情之一是左移安全，但也要屏蔽右移。左移安全的概念是，当你写代码的时候，你应该把你的开发人员送到安全的代码培训，你应该实现一个工具，这个工具会监视他们写不安全的代码，当他们写不安全的代码时，对他们大喊大叫。寻找一个解决方案，你可以用应用程序编译 SDK，如果你有一个基于应用程序的架构，那么，把安全转移到左边:当产品被创建时，当代码被编写时，实现安全。

“保护权利”的理念是，不仅要在编写时保护它，还要在它部署到生产环境后保护它。因为我们知道网络安全是一个非常转瞬即逝的行业。它移动得非常快。就在你我谈话的这段时间，又有几个新的零日漏洞出现了。每隔几分钟就会有新的漏洞和漏洞出现，所以你需要对即将发生的事情保持警惕。

未知的未知。这就是现在让每个人都紧张的原因，也是现在让很多人被攻破的原因——未知的未知。对我来说，已知是传统的安全控制，如网络入侵检测，就像过去的 Snort，当你为这些漏洞编写 Snort 签名时，你基本上是在记录已知的已知。但是未知的未知呢？我不知道什么是我还不知道的，所以这就是神盾局可以带我们去未来了解我们不知道的事情的地方。

拉里:我刚看完妮可·珀尔罗斯的一本书，[他们是这样告诉我世界末日的](https://thisishowtheytellmetheworldends.com/)。

艾丽莎:哦，妮可，实际上我刚刚[在 MoneyFest，Money2020 上采访了她](https://www.money2020.com/moneyfest/event/how-should-we-be-keeping-data-secure-e21-43745)。所以如果你还没看过，我强烈建议你和你的观众去看一看。这是一本很棒的书。她是纽约时报的一名非常非常出色的记者。

拉里:对。这本书又长又厚。一本厚书。它读起来像一部犯罪惊悚片，涵盖了整个剥削行业，从 2000 年、2002 年的早期开始。左移右护的绝佳视角。我喜欢这个比喻。

## PHI 的价值是信用卡信息的一千倍

你的医疗保健信息是持久的，如果它被发布到黑暗的网络上，它就消失了，无法改变或恢复。相比之下，在 Target 被黑客攻击后，银行只是简单地给你邮寄一张新的信用卡。

拉里:继续前进。由于 Moesif 用于一系列健康技术应用程序，并且我们的一些观众在健康技术部门工作，根据您的经验，ePHI(电子患者医疗保健信息)或个人银行信息在黑暗网络上更有价值，为什么？

艾丽莎:哦，实际上我对此做过研究。这是一个很好的问题。所以很明显，在我的工作中，我经常浏览 Tor 网站，黑色网站，我可以告诉你的一件事是，电子健康记录的价值是美国信用卡号码的 1000 倍。所以当你有一个 PHI 记录，EHR 记录，不管你怎么称呼它，你有很多数据。所以，如果我妥协了，在妥协中，我偷了拉里的信用卡号码，你的银行可以很快发给你一张新卡。银行花了几块钱。他们送你一张新卡，你有一张全新的卡，你很好。

如果我泄露了你的健康史，并把它放在黑网上出售，你有多容易通过邮件获得新的健康史？不可能的。没有这回事。它不见了。一旦公开，就结束了。如果我想知道如何杀死拉里，我找到他的 PHI，我发现他对蜜蜂叮咬过敏。所以我带着大黄蜂去追你。但事情一旦发生就无法挽回了。这也是我认为它价值如此之高的原因之一。另一件事是，已经妥协了这么多的医疗保健 API，我可以告诉你，那里有一个数据宝库。

有一次，我不仅看到了医院的入院记录，还看到了那个人的家庭成员信息。所以，当你去一家医院，他们要求近亲信息和所有这些其他的东西，所有这些其他的数据，他们需要知道，这就形成了一个非常丰富的内容，非常丰富的数据环境。在 PHI 记录中有很多关于个人信息的数据，这就是为什么我们需要如此认真地对待这个问题，这也是我很多医疗保健研究的动力。

当你谈论人们的健康时，这和破坏一个公司网站是完全不同的。在过去的二十年里，发生了太多的变化。我是说，以前我在 IRC 上玩这个的时候，都是关于，地狱世界的大规模毁损。现在是钱。这是一个利润丰厚的行业。当你谈到黑暗面和这些勒索软件集团带来的数千万美元时，这是疯狂的。我的意思是，许多勒索软件集团比一些国家赚得更多，手头的现金比一些大公司还多。所以很恐怖。这是一个巨大的行业，对于你的问题，冗长的答案是 PHI 绝对比财务数据更有价值。

这并不是说，不要误会我的意思，拉里，这并不是说它不重要，它只需要比 PHI 少得多的钱。

## 原料药是医疗保健中最薄弱的环节

最大的问题之一是 PHI 的监管链，数据从一个非常安全的 API 转移到一个不太安全的 API。Cerner 和 Epic 有非常强的安全性，但是一旦 PHI 离开了 API，你就不知道下一个系统有多安全了。黑客瞄准了不太安全的 API——拆东墙补西墙。

**Larry:** 考虑到 PHI 和 EHR 的患者记录如此宝贵，锁定 healthtech APIs 是否存在独特的挑战，相对于那些来自 fintech 的挑战？

Alissa: 我认为 API 可能是安全方面最薄弱的环节。不同的医疗保健提供商将使用不同的人力资源系统，无论是 Epic 还是 Cerner 或其他系统，请填写此处的空白。这些系统之前，我相信我们会谈到这一点，但在 FHIR 之前，他们不能互相交谈。有一些问题，例如，如果我的目标是像塞尔纳·EHR 系统这样的系统，它可能受到非常非常好的保护，非常安全，但一旦那些 PHI 离开该系统，转而使用不太安全的 API，作为一名黑客，你认为我会以哪里为目标呢？我将针对安全性较低的 API。我要走阻力最小的路。

我认为最大的问题之一是监管链，或最薄弱的环节——PHI 可以从一个非常安全的 API 变成一个不太安全的 API。它不太安全，因为编写它的人只是一些小企业，他们不知道自己在做什么，也不知道任何关于安全的事情。我抢劫了他们。我抢了保罗而不是彼得。

此外，我认为第二件事是普遍性，我甚至敢说，在我观察的许多移动应用程序中，这是非常系统化的，在这种移动健康或移动健康应用程序的新概念中，API 密钥和令牌以明文形式存储在移动应用程序中，或以明文形式硬编码。开发人员只是伸出他们的手臂说，“嘿，如果我不能把它们存储在应用程序中，我应该把它们存储在哪里？”他们不知道该把它们放在哪里。所以这确实是个问题。我认为在应用程序方面存在问题，密钥和凭证被硬编码，然后在 API 所在的后端也存在问题。

## API 有多个攻击面

由于数据无处不在，城堡和壕沟的安全是不可能的。攻击面很广，从面向合作伙伴的 API(考虑供应链威胁),到 web APIs(没有 SDK 来捆绑额外的安全性),再到中间人攻击(证书安全性影响服务器/客户端 API 安全性)。

拉里:对。您能否详细介绍一下 ePHIs 可能受到攻击的不同攻击面，以及如何加强这些攻击面？我们讨论了一些应用程序本身，但是关键商店、网络、API 端点以及数据泄露又如何呢？

当然可以。显然到处都有数据。城堡和护城河的整个概念在这一点上被完全抹去了。你控制不了。因此，在客户端，密钥和令牌或凭证的硬编码才是真正的问题。您有不同类型的 API，所以让我们来讨论不同的攻击面。

您有面向合作伙伴的 API，其中供应链攻击是当今的真正威胁。我甚至不需要从网上追踪你，我可以找到你和谁做生意，然后追踪他们。因为你们两个之间有联系，通过一个合作伙伴 API，一个 B2B API，它正对着你们两个公司，我加入了。因为不管是谁写的，都觉得这是一个面向 API 的合作伙伴，而不是面向互联网的合作伙伴，所以我们不用太担心安全性。

你有 web APIs，如果你没有移动应用，客户端的安全控制将会大不相同。虽然你可以用移动应用程序编译一个 SDK 来增加额外的安全层，但是当你不能用 SDK 编译 Chrome 浏览器时，你该如何处理 web APIs 呢？让谷歌帮你发布吗？

还有一个关于中间人/中间人/中间人攻击的问题，在这种情况下，许多组织没有实施证书锁定。作为一名攻击者，我可以用很多这样的应用程序将自己插入到客户端和后端 API 之间的通信中。然后我向两个方向提交 SSL 证书，告诉 API 我是客户机，告诉 API 客户机我是 API 端点的 API 服务器。他们都认为他们在和对方说话，但他们实际上是在和我说话。这使我能够解密 SSL 加密的流量并查看它。我可以通过拦截流量并解密，然后将这些 API 请求复制并粘贴到我自己的 API 客户端(如 Postman)来了解 API 的工作原理。然后，我可以用 API 客户机自己手动跟踪 API 端点。

## 禁止监狱坏手机上的应用程序没有帮助

黑客不在乎你的手机应用程序是否能在越狱的手机上运行。下载 APK，或者拦截从手机应用程序到&的 L7 流量，通常足以找出如何访问所有数据。

拉里:明白了。我最近听了你的一个教程，是关于如何真正做到这一点的，而且出乎意料的简单。我也不是超级伟大的程序员。事实上，我根本不是一个程序员。但是有一点令人震惊的是，你可以通过下载到你的 MAC 上的 Postman 和一些软件包，把所有的信息都提取出来。

艾丽莎: [《吃豆人》](https://archlinux.org/pacman/)让事情出奇的简单。这是一个像[红帽转速](https://github.com/rpm-software-management)和真正强大的包管理器。这些工具很多都是免费下载的。比如我觉得叫[高级休息客户端](https://install.advancedrestclient.com/install)，那是免费下载的。问题是，当你进行黑客攻击时，这是我不明白的，许多开发人员会实现安全性，并说“哦，别担心，我们希望确保移动应用程序不会在越狱或路由的手机上运行。”我不在乎那个。我不需要在越狱的手机上运行它。面对许多这样的 API 攻击，我只是从我的 android 设备上提取了 APK。然后使用 [Apk Extractor](https://play.google.com/store/apps/details?id=com.ext.ui&hl=en_US&gl=US) 将它加载到我工作站上的工具中，讽刺的是，你可以从谷歌商店下载。我不需要执行它。我不需要在监狱环境中运行它。我可以在笔记本电脑或工作站上完成所有这些工作。

或者，我甚至可以在 android 设备上运行它，并用工具拦截流量。然后再次访问所有数据。信不信由你，我更喜欢这样做，而不是看 API 文档。对于 FHIR，有很多关于它的文档，因为 FHIR 的要点是你已经为它开发了。但我更喜欢实际拦截流量并观察它。我是一只包猴。我倾向于通过查看包和 API 在第三层如何工作来学习，而不仅仅是阅读文档。

## 使用 MobSF 查找 API 密钥

要解构一个应用程序，只需将 APK 文件拖放到 MobSF 中，它只需将其拆开，还原到原始源代码，然后用 Grep 找到硬编码的密钥/令牌。

拉里:我注意到你是 [Grep](https://www.gnu.org/software/grep/) 的支持者。

是的，我是一个希腊女孩。哇，你看了我的视频，不是吗？但谢谢你跟踪我，我很感激。爱我的粉丝。

有一个很棒的工具叫做 [MobSF](https://github.com/MobSF) ，给那些可能不熟悉它的观众。它被称为移动安全框架，它允许您将数据包 APK 文件拖放到该工具中，然后它会对其进行解构。它只是把它拆开，倒回到原来的源代码。所以我才能找到所有这些硬编码的钥匙和令牌。有趣的是，很符合你的观点。我不喜欢使用图形用户界面，实际上我会用它来返回源代码。然后我进入我的命令外壳，进入终端，使用一串 Grep 字符串。这是我在应用程序中寻找硬编码 API 秘密的首选方式。

## 原料药需要符合 FHIR

最近的《医疗法案》规定医疗技术公司需要向请求者提供患者数据。符合 FHIR 的 API 提供了一种安全的方式来满足这些需求。

拉里:有趣的东西。继续关注 [HL7](https://www.hl7.org/) 的工作以及他们即将发布的最新版本 [FHIR(快速医疗互操作性资源)](https://www.hl7.org/fhir/)标准。这项工作有多重要，开发人员是否应该按照最新的 FHIR 标准进行构建，您认为这对医疗保健领域的 API 安全行业有多重要？

艾丽莎:这一点都不重要——不，只是开玩笑。这是巨大的。在我所有的脆弱性研究中，这可能是我做过的最重要的事情，因为你知道，我接触了很多来自医疗保健行业的人，谈论这项研究有多么重要。

很多人不知道这一点，但他们自然而然地认为我们黑客天生就知道这些东西。我不知道怎么拼写 FHIR，更不知道当我走进这里的时候它到底是什么。我不得不做作业。我不得不研究。我甚至不知道 HL7 是谁。HL7 是组织的名称，也是标准的名称。这就像是整张面巾纸。这些都是我需要研究和理解的。这花了我几个月的时间，我仍然不知道它的全部，我仍然不完全理解它的许多内容。我对这项研究感到非常兴奋。我目前正在研究 FHIR 的 R4，这是该标准的第 4 版。

它是由 HL7 国际组织创建的，健康七级国际组织，就像你提到的，在 FHIR 之前，有所有这些在 FHIR 之前的 HL7 的不同版本。并且 [ONC(国家健康信息协调员办公室)](https://www.healthit.gov/)已经基本上为医疗保健支付者和医疗保健提供者设定了这些截止日期，并且说“你需要使这些[患者数据](https://www.federalregister.gov/documents/2020/05/01/2021-07419/21st-century-cures-act-interoperability-information-blocking-and-the-onc-health-it-certification)对请求它的人可用，否则你就违反了这个数据封锁规则，信息封锁规则。”这可能意味着严厉的处罚和罚款。如果你被发现违反了这条[信息封锁条例](https://www.healthit.gov/topic/information-blocking)，那可就麻烦了。这有一个截止日期，组织和医疗保健支付者需要实现 FHIR APIs，并使这些医疗保健数据可用。

唯一的事情是，我想展示当这些 API 没有被正确保护时会发生什么。这是这项研究的动力。这是我过去一年一直关注的。这项研究的第一阶段目标是存储医疗数据的移动医疗 API。在第二部分，我们称之为玩 FHIR，我们专注于入侵 FHIR APIs。这就是即将发布的报告将详细介绍的内容，它将给出我们的发现以及我们在那里看到的情况。有很多，我真的很兴奋能够公布这项研究。我知道你们在医疗保健领域也做了很多工作。医疗保健是一个目标非常丰富的环境。那里有如此多的钱，黑客们知道这一点。数据太多了，通过这些易受攻击的 API 很容易获取。

## 正确实施 FHIR

使用 OAuth、认证、授权和其他最佳实践创建坚如磐石的 FHIR APIs。如果人类实现了它们，它们就会有漏洞。让他们很难被发现。

拉里:在这里戳熊，但如果修订版 4 即将推出，你一直在努力，许多其他聪明人也一直在努力，它发布后会有很多漏洞吗？或者，它将会是安全健康、移动健康和 ePHI 超越 AIPs 的涅槃，继续前进？

**Alissa:** 我需要向您的观众澄清，当您部署 FHIR 时，您不会真的像购买收缩包装的 FHIR API 一样购买，并确保将安全性包括在内然后它就展开了。这将取决于实施。

一个组织可能实现了一个 FHIR API，但是没有遵循最佳实践，因此它非常容易受到攻击。但是，另一个组织可能会实现 FHIR APIs 并使之坚如磐石。漏洞在哪里可能并不明显。也许会比其他组织花更长的时间来找到它。我永远不会说任何事情都是不可破解的。如果人类正在实现它，它会有漏洞，但它们可能更难被发现。这就是他的特点。你和我都可以实现 FHIR APIs 来服务我们的 PHI 记录，但是你的可能比我的更安全，因为我不知道我在做什么，而且我实现得不安全。

所以要看实现。这取决于谁在实施它，以及他们是否知道如何正确地保护它。因此，在 FHIR 上的智能带来了 [OAuth](https://en.wikipedia.org/wiki/OAuth) 和所有其他事情，如认证和授权。因此，实现 FHIR 当然在很大程度上取决于实现者，以及他们是否正确地实现了它。

## 获得 FHIR 认证

作为额外的检查，让你的 FHIR API 获得认证是值得的。

**Alissa:** 现在，我真的想插一句——组织可以通过一个认证过程来获得 FHIR API 认证。因此，如果你要实现一个 FHIR API，我也要实现一个，我实际上可以让我的 FHIR API 获得认证，证明它是根据标准实现的，并有适当的安全控制。您可以继续运行您的 FHIR APIs，但无需认证。这不是强制性的。你不需要得到你的认证。

在这项研究中，我接触过的 EHR 供应商当然都在追求认证。但是你可以有非认证的和认证的 API。这意味着易受攻击和非易受攻击的 API 将会非常多。我这么说的时候要小心，因为我并不是说一个经过认证的 API 将是安全的和不可破解的，我只是说你将拥有两者的混合。

## FHIR 认证与 HIPAA 合规性

与 HIPAA 不同，FHIR 有第三方机构可以认证你的 API。

拉里:这听起来有点像 HIPAA 合规，没有第三方认证机构；有您应该遵循的最佳实践，也有人会审核您构建的内容，但是 HIPAA 基本上是您应该遵循的一系列指导原则。听起来，HL7 更进了一步，有第三方机构可以检查你是否按照标准实现了 FHIR。

**Alissa:** 我采访过的一家 EHR 供应商，我不会说出他们的名字，但他们确实说他们正在争取年底前获得认证，这将使他们成为第一家获得 FHIR 的公司。我不知道谁是真正的认证机构，也许是 HL7，我不知道。但是你绝对可以选择去获得认证或者不获得认证，就你的例子来说，你不需要这样做。

## API 安全没有一个合适的解决方案

有很多很好的 API 安全解决方案。但是实际的最佳方法是什么，我不知道是否会有答案。

拉里:明白了。好了，我们今天的播客已经涵盖了很多内容。关于如何保护你的 API，特别是你的移动医疗和医疗技术 API，你已经给出了很多精彩的见解。作为倒数第二点，我们还没有看到 API 和安全性的下一步是什么？

艾丽莎:我认为#更多请。这是结束节目和面试的好方法。首先，如果我戴上算命的帽子，这绝对是世界前进的方向:我们正在完全远离整体架构，转向微服务，一切都在转向云，一切都是由 API 驱动的微服务。我认为我们将会看到越来越多的这种情况。

问题是组织将从运行 1 到 2 个 API，发展到运行 1，000 到 2，000 个 API。我现在正在与一个拥有超过 1600 个 API 的组织合作。这么多 API。我认为这将创造一个更大的市场。在向 Gartner 提交的关于 API 状态的演示文稿中，有一点是市场正在经历一场身份危机。

API 安全市场还不知道它是什么。每一家拥有 API 安全威胁管理解决方案的公司都相信他们的做法是正确的。这不一定是错的。每一家公司可能都在用正确的方法处理 API 安全问题，但是我认为陪审团仍然不知道它会落在哪里。它是在线的吗？是被动吗？我们用 SDK 吗？我们使用分布式跟踪吗？我们是否使用…有很多非常棒的方法，其中很多是我的客户，他们都有很好的解决方案。实际的最佳方法是什么，我不知道是否会有答案。

但我知道什么是错误的方法。我们已经在节目中讨论过这一点，那就是这些传统的基于规则的系统，如 Web 应用程序防火墙。或者，我们已经有了一个 API 管理解决方案，让它来确保安全性。我的研究表明，我可以攻击和破坏这些 API，并通过受 WAFs 和 API 网关保护的 API 窃取所有这些数以千计的患者记录，这证明了没有人应该使用这些来保护他们的 API。他们应该关注像 [Moesif](https://www.moesif.com/solutions/api-security) 这样的解决方案，关注像 [Traceable](https://www.traceable.ai/) 和 [Approve](https://www.approov.io/) 这样的其他威胁管理解决方案，以及其他许多优秀的解决方案。

## 检测您的 API

保护您的 API 最重要的一步是了解它们发生了什么。给自己配备一个工具，让你能够深入研究你的 API 的流量。

首先，每个人都需要明白的是，你无法保护你不知道自己拥有的东西。您需要知道您有多少 API，它们提供什么类型的数据，它们是否与互联网隔开(我可以从互联网访问它们吗)或者它们是否面向合作伙伴，我们是否授权和认证(我们给予您对此的认证访问，但是我们是否授权您可以请求什么数据)？所有这些都非常重要。了解您的 API 服务的数据类型。如果我有 1600 个 API，你认为我会知道哪些 API 服务于 PII 或 PHI，哪些服务于 PCI 数据吗？我应该知道这一点，但我不可能记住它，所以我需要一个工具来做这件事。我对你们所有人的建议是*知道哪些数据将进入你们的 API，拦截它，查看它，分析它*。知道那里发生了什么，知道什么占用了 API 的带宽，以及正在发送什么 API 请求。用工具装备你自己，这将给予你观察它的能力。

拉里:然后采取行动。多么精彩的总结和采访收获。我的最后一个问题:我们的观众在哪里可以找到更多关于艾丽莎的信息，你接下来会在哪里演讲？我知道你是一个非常多产的主题演讲人。艾丽莎会有什么下场？我们的观众还应该关注哪些资源？

作为一名内容创作者和电影制作人，我认为我发布漏洞研究和内容的主要渠道是 YouTube。所以，一定要订阅我的 [YouTube 频道](https://www.youtube.com/c/AlissaKnight/videos)，打破通知的铃声图标。但是，也请在 [Twitter](https://twitter.com/alissaknight) 上关注我，并在 [LinkedIn](https://www.linkedin.com/in/alissaknight) 上与我联系。总的来说，我喜欢对 API 安全和黑客技术的研究。我有一本关于通过 Wiley 入侵 API 的新书要出版了。我的第二本书。我正在为一部新电视剧写剧本。我的世界里发生了很多事情，我肯定会敦促所有人在 YouTube、LinkedIn 和 Twitter 上关注我，因为这是我的主要去处。除非他们想看我食物的照片，否则我会在 Instagram 上发布我食物的照片。

我感谢你们所有人，作为我的网络的一部分，我的追随者和粉丝们请保持关注，因为这将是非常令人兴奋的一年。我将在 HIMSS 上发表演讲，我想说，这可能是世界上最大的医疗保健会议，我将在那里做主题演讲。除了其他一些令人惊叹的主题演讲人，如 A-Rod 和 Michael Coats。

如果有人想过来打个招呼，我肯定会看看会发生什么，我也会在 DEFCON 上发言，今年我会在 30 多个会议上发言。所以很多激动人心的事情。我还将在即将到来的 Money2020 会议上发表主题演讲。这真的很令人兴奋。实际上，我会在我的网站[这里](https://www.alissaknight.com/upcoming-events)和【KnightInkMedia.com T2】T3】上发布我的活动日程，请留意。再说一次，找我的最好方式是在社交媒体上。

拉里:太好了。非常感谢艾丽莎今天抽出时间。我相信我们的观众会非常喜欢这个播客。

谢谢你。感激不尽。